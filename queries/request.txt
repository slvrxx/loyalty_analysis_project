ВЫБРАТЬ
	Продажи.Контрагент.ГоловнойКонтрагент.Код КАК ИД_Контрагент,
	Продажи.ЗаказПокупателя.Грузополучатель.Код КАК ИД_Грузополучатель,
	ЗначенияСвойствОбъектов.Значение КАК ПризнакКонтрагента,
	ВЫБОР
		КОГДА Продажи.Номенклатура.НоменклатурнаяГруппаРКД ЕСТЬ NULL
			ТОГДА "Прочее"
		ИНАЧЕ Продажи.Номенклатура.НоменклатурнаяГруппаРКД
	КОНЕЦ КАК ТипНоменклатуры,
	СУММА(Продажи.Количество * Продажи.Номенклатура.ЕдиницаХраненияОстатков.Вес) КАК Количество,
	СУММА(Продажи.Стоимость) КАК Стоимость,
	Продажи.Контрагент.ГоловнойКонтрагент,
	Продажи.ЗаказПокупателя.Номер,
	Продажи.ЗаказПокупателя.Дата,
	Продажи.Период
ПОМЕСТИТЬ TT_Sales
ИЗ
	РегистрНакопления.Продажи КАК Продажи
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ РегистрСведений.ЗначенияСвойствОбъектов КАК ЗначенияСвойствОбъектов
		ПО Продажи.Контрагент = ЗначенияСвойствОбъектов.Объект
ГДЕ
	Продажи.Период МЕЖДУ &ДатаНач И &ДатаКон
	И НЕ Продажи.Номенклатура В (&Номенклатура)
	И Продажи.Контрагент В ИЕРАРХИИ(&Контрагент)
	И ЗначенияСвойствОбъектов.Свойство = &Категория

СГРУППИРОВАТЬ ПО
	Продажи.Контрагент.ГоловнойКонтрагент,
	ЗначенияСвойствОбъектов.Значение,
	ВЫБОР
		КОГДА Продажи.Номенклатура.НоменклатурнаяГруппаРКД ЕСТЬ NULL
			ТОГДА "Прочее"
		ИНАЧЕ Продажи.Номенклатура.НоменклатурнаяГруппаРКД
	КОНЕЦ,
	Продажи.ЗаказПокупателя.Грузополучатель.Код,
	Продажи.ЗаказПокупателя.Номер,
	Продажи.ЗаказПокупателя.Дата,
	Продажи.Период,
	Продажи.Контрагент.ГоловнойКонтрагент.Код